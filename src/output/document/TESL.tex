%
\begin{isabellebody}%
\setisabellecontext{TESL}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupchapter{The Core of the TESL Language: Syntax and Basics%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ TESL\isanewline
\isakeyword{imports}\ Main\isanewline
\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Syntactic Representation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We define here the syntax of TESL specifications.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Basic elements of a specification%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The following items appear in specifications:

%
\begin{itemize}%
\item Clocks, which are identified by a name.

\item Tag constants are just constants of a type which denotes the metric time space.%
\end{itemize}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{datatype}\isamarkupfalse%
\ \ \ \ \ clock\ \ \ \ \ \ \ \ \ {\isacharequal}\ Clk\ {\isacartoucheopen}string{\isacartoucheclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ instant{\isacharunderscore}index\ {\isacharequal}\ {\isacartoucheopen}nat{\isacartoucheclose}\isanewline
\isanewline
\isacommand{datatype}\isamarkupfalse%
\ {\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const\ {\isacharequal}\isanewline
\ \ \ \ TConst\ \ \ {\isacharprime}{\isasymtau}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isachardoublequoteopen}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t{\isachardoublequoteclose}{\isacharparenright}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Operators for the TESL language%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The type of atomic TESL constraints, which can be combined to form specifications.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{datatype}\isamarkupfalse%
\ {\isacharprime}{\isasymtau}\ TESL{\isacharunderscore}atomic\ {\isacharequal}\isanewline
\ \ \ \ SporadicOn\ \ \ \ \ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}{\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const{\isacartoucheclose}\ \ {\isacartoucheopen}clock{\isacartoucheclose}\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isachardoublequoteopen}{\isacharunderscore}\ sporadic\ {\isacharunderscore}\ on\ {\isacharunderscore}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ TagRelation\ \ \ \ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}{\isacharparenleft}{\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const\ {\isasymtimes}\ {\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const{\isacharparenright}\ {\isasymRightarrow}\ bool{\isacartoucheclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isachardoublequoteopen}time{\isacharminus}relation\ {\isasymlfloor}{\isacharunderscore}{\isacharcomma}\ {\isacharunderscore}{\isasymrfloor}\ {\isasymin}\ {\isacharunderscore}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ Implies\ \ \ \ \ \ \ \ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}implies{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ ImpliesNot\ \ \ \ \ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}implies\ not{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ TimeDelayedBy\ \ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}{\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacharparenleft}{\isachardoublequoteopen}{\isacharunderscore}\ time{\isacharminus}delayed\ by\ {\isacharunderscore}\ on\ {\isacharunderscore}\ implies\ {\isacharunderscore}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ WeaklyPrecedes\ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}weakly\ precedes{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ StrictlyPrecedes\ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}strictly\ precedes{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ {\isacharbar}\ Kills\ \ \ \ \ \ \ \ \ \ \ \ {\isacartoucheopen}clock{\isacartoucheclose}\ {\isacartoucheopen}clock{\isacartoucheclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}kills{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}%
\begin{isamarkuptext}%
A TESL formula is just a list of atomic constraints, with implicit conjunction for the semantics.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ {\isacharprime}{\isasymtau}\ TESL{\isacharunderscore}formula\ {\isacharequal}\ {\isacartoucheopen}{\isacharprime}{\isasymtau}\ TESL{\isacharunderscore}atomic\ list{\isacartoucheclose}%
\begin{isamarkuptext}%
We call \emph{positive atoms} the atomic constraints that create ticks from nothing.
  Only sporadic constraints are positive in the current version of TESL.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ positive{\isacharunderscore}atom\ {\isacharcolon}{\isacharcolon}\ {\isacartoucheopen}{\isacharprime}{\isasymtau}\ TESL{\isacharunderscore}atomic\ {\isasymRightarrow}\ bool{\isacartoucheclose}\ \isakeyword{where}\isanewline
\ \ \ \ {\isacartoucheopen}positive{\isacharunderscore}atom\ {\isacharparenleft}{\isacharunderscore}\ sporadic\ {\isacharunderscore}\ on\ {\isacharunderscore}{\isacharparenright}\ {\isacharequal}\ True{\isacartoucheclose}\isanewline
\ \ {\isacharbar}\ {\isacartoucheopen}positive{\isacharunderscore}atom\ {\isacharunderscore}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}\ False{\isacartoucheclose}%
\begin{isamarkuptext}%
The \isa{NoSporadic} function removes sporadic constraints from a TESL formula.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{abbreviation}\isamarkupfalse%
\ NoSporadic\ {\isacharcolon}{\isacharcolon}\ {\isacartoucheopen}{\isacharprime}{\isasymtau}\ TESL{\isacharunderscore}formula\ {\isasymRightarrow}\ {\isacharprime}{\isasymtau}\ TESL{\isacharunderscore}formula{\isacartoucheclose}\isanewline
\isakeyword{where}\ \isanewline
\ \ {\isacartoucheopen}NoSporadic\ f\ {\isasymequiv}\ {\isacharparenleft}List{\isachardot}filter\ {\isacharparenleft}{\isasymlambda}f\isactrlsub a\isactrlsub t\isactrlsub o\isactrlsub m{\isachardot}\ case\ f\isactrlsub a\isactrlsub t\isactrlsub o\isactrlsub m\ of\isanewline
\ \ \ \ \ \ {\isacharunderscore}\ sporadic\ {\isacharunderscore}\ on\ {\isacharunderscore}\ {\isasymRightarrow}\ False\isanewline
\ \ \ \ {\isacharbar}\ {\isacharunderscore}\ {\isasymRightarrow}\ True{\isacharparenright}\ f{\isacharparenright}{\isacartoucheclose}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Field Structure of the Metric Time Space%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
In order to handle tag relations and delays, tags must belong to a field.
  We show here that this is the case when the type parameter of \isa{{\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const} 
  is itself a field.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ tag{\isacharunderscore}const\ {\isacharcolon}{\isacharcolon}{\isacharparenleft}field{\isacharparenright}field\isanewline
\isakeyword{begin}\isanewline
\ \ \isacommand{fun}\isamarkupfalse%
\ inverse{\isacharunderscore}tag{\isacharunderscore}const\isanewline
\ \ \isakeyword{where}\ {\isacartoucheopen}inverse\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t{\isacharparenright}\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isacharparenleft}inverse\ t{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\ \ \isacommand{fun}\isamarkupfalse%
\ divide{\isacharunderscore}tag{\isacharunderscore}const\ \isanewline
\ \ \ \ \isakeyword{where}\ {\isacartoucheopen}divide\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isacharparenleft}divide\ t\isactrlsub {\isadigit{1}}\ t\isactrlsub {\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\ \ \isacommand{fun}\isamarkupfalse%
\ uminus{\isacharunderscore}tag{\isacharunderscore}const\isanewline
\ \ \ \ \isakeyword{where}\ {\isacartoucheopen}uminus\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t{\isacharparenright}\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isacharparenleft}uminus\ t{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ minus{\isacharunderscore}tag{\isacharunderscore}const\isanewline
\ \ \isakeyword{where}\ {\isacartoucheopen}minus\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isacharparenleft}minus\ t\isactrlsub {\isadigit{1}}\ t\isactrlsub {\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacartoucheopen}one{\isacharunderscore}tag{\isacharunderscore}const\ {\isasymequiv}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ times{\isacharunderscore}tag{\isacharunderscore}const\isanewline
\ \ \isakeyword{where}\ {\isacartoucheopen}times\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isacharparenleft}times\ t\isactrlsub {\isadigit{1}}\ t\isactrlsub {\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacartoucheopen}zero{\isacharunderscore}tag{\isacharunderscore}const\ {\isasymequiv}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ plus{\isacharunderscore}tag{\isacharunderscore}const\isanewline
\ \ \isakeyword{where}\ {\isacartoucheopen}plus\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}{\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ t\isactrlsub {\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isacharparenleft}plus\ t\isactrlsub {\isadigit{1}}\ t\isactrlsub {\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
%
\begin{isamarkuptext}%
Multiplication is associative.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ c{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ w\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}c\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ w{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}a\ {\isacharasterisk}\ b\ {\isacharasterisk}\ c\ {\isacharequal}\ a\ {\isacharasterisk}\ {\isacharparenleft}b\ {\isacharasterisk}\ c{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}times{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Multiplication is commutative.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}\ a\ {\isacharasterisk}\ b\ {\isacharequal}\ b\ {\isacharasterisk}\ a{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}times{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
One is neutral for multiplication.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{1}}\ {\isacharasterisk}\ a\ {\isacharequal}\ a{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}times{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ one{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Addition is associative.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ c{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ w\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}c\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ w{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}a\ {\isacharplus}\ b\ {\isacharplus}\ c\ {\isacharequal}\ a\ {\isacharplus}\ {\isacharparenleft}b\ {\isacharplus}\ c{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}plus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Addition is commutative.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}a\ {\isacharplus}\ b\ {\isacharequal}\ b\ {\isacharplus}\ a{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}plus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Zero is neutral for addition.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharplus}\ a\ {\isacharequal}\ a{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}plus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ zero{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
The sum of an element and its opposite is zero.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharminus}a\ {\isacharplus}\ a\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}plus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TESL{\isachardot}uminus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ zero{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Subtraction is adding the opposite.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}a\ {\isacharminus}\ b\ {\isacharequal}\ a\ {\isacharplus}\ {\isacharminus}b{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}minus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ TESL{\isachardot}plus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ TESL{\isachardot}uminus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Distributive property of multiplication over addition.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ c{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ w\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}c\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ w{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}a\ {\isacharplus}\ b{\isacharparenright}\ {\isacharasterisk}\ c\ {\isacharequal}\ a\ {\isacharasterisk}\ c\ {\isacharplus}\ b\ {\isacharasterisk}\ c{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}plus{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TESL{\isachardot}times{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ring{\isacharunderscore}class{\isachardot}ring{\isacharunderscore}distribs{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
The neutral elements are distinct.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}{\isacharparenleft}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacharparenright}{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ one{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def\ zero{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
The product of an element and its inverse is 1.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isacommand{assume}\isamarkupfalse%
\ h{\isacharcolon}{\isacartoucheopen}a\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{with}\isamarkupfalse%
\ h\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}u\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ zero{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}inverse\ a\ {\isacharasterisk}\ a\ {\isacharequal}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}inverse{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ TESL{\isachardot}times{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ one{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Dividing is multiplying by the inverse.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{fix}\isamarkupfalse%
\ a{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ b{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ u\ v\ \isakeyword{where}\ {\isacartoucheopen}a\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ u{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}b\ {\isacharequal}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ v{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacartoucheopen}a\ div\ b\ {\isacharequal}\ a\ {\isacharasterisk}\ inverse\ b{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}divide{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TESL{\isachardot}inverse{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TESL{\isachardot}times{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ divide{\isacharunderscore}inverse{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
%
\begin{isamarkuptext}%
Zero is its own inverse.%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}inverse\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}{\isacharparenleft}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}field\ tag{\isacharunderscore}const{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ TESL{\isachardot}inverse{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ zero{\isacharunderscore}tag{\isacharunderscore}const{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
For comparing dates on clocks, we need an order on tags.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ tag{\isacharunderscore}const\ {\isacharcolon}{\isacharcolon}\ {\isacharparenleft}order{\isacharparenright}order\isanewline
\isakeyword{begin}\isanewline
\ \ \isacommand{inductive}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}tag{\isacharunderscore}const\ {\isacharcolon}{\isacharcolon}\ {\isacartoucheopen}{\isacharprime}a\ tag{\isacharunderscore}const\ {\isasymRightarrow}\ {\isacharprime}a\ tag{\isacharunderscore}const\ {\isasymRightarrow}\ bool{\isacartoucheclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ Int{\isacharunderscore}less{\isacharunderscore}eq{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \ \ \ \ \ {\isacartoucheopen}n\ {\isasymle}\ m\ {\isasymLongrightarrow}\ {\isacharparenleft}TConst\ n{\isacharparenright}\ {\isasymle}\ {\isacharparenleft}TConst\ m{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\ \ \isacommand{definition}\isamarkupfalse%
\ less{\isacharunderscore}tag{\isacharcolon}\ {\isacartoucheopen}{\isacharparenleft}x{\isacharcolon}{\isacharcolon}{\isacharprime}a\ tag{\isacharunderscore}const{\isacharparenright}\ {\isacharless}\ y\ {\isasymlongleftrightarrow}\ {\isacharparenleft}x\ {\isasymle}\ y{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}x\ {\isasymnoteq}\ y{\isacharparenright}{\isacartoucheclose}\isanewline
\isanewline
\ \ \isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}{\isasymAnd}x\ y\ {\isacharcolon}{\isacharcolon}\ {\isacharprime}a\ tag{\isacharunderscore}const{\isachardot}\ {\isacharparenleft}x\ {\isacharless}\ y{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}x\ {\isasymle}\ y\ {\isasymand}\ {\isasymnot}\ y\ {\isasymle}\ x{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ less{\isacharunderscore}tag\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}a\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{obtain}\isamarkupfalse%
\ x\isactrlsub {\isadigit{0}}{\isacharcolon}{\isacharcolon}{\isacharprime}a\ \isakeyword{where}\ {\isacartoucheopen}x\ {\isacharequal}\ TConst\ x\isactrlsub {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ Int{\isacharunderscore}less{\isacharunderscore}eq\ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}x\ {\isasymle}\ x{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}{\isasymAnd}x\ y\ z\ \ {\isacharcolon}{\isacharcolon}\ {\isacharprime}a\ tag{\isacharunderscore}const{\isachardot}\ x\ {\isasymle}\ y\ {\isasymLongrightarrow}\ y\ {\isasymle}\ z\ {\isasymLongrightarrow}\ x\ {\isasymle}\ z{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}{\isasymAnd}x\ y\ \ {\isacharcolon}{\isacharcolon}\ {\isacharprime}a\ tag{\isacharunderscore}const{\isachardot}\ x\ {\isasymle}\ y\ {\isasymLongrightarrow}\ y\ {\isasymle}\ x\ {\isasymLongrightarrow}\ x\ {\isacharequal}\ y{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
For ensuring that time does never flow backwards, we need a total order on tags.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{instantiation}\isamarkupfalse%
\ tag{\isacharunderscore}const\ {\isacharcolon}{\isacharcolon}\ {\isacharparenleft}linorder{\isacharparenright}linorder\isanewline
\isakeyword{begin}\isanewline
\ \ \isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}a\ tag{\isacharunderscore}const{\isacartoucheclose}\ \isakeyword{and}\ y{\isacharcolon}{\isacharcolon}{\isacartoucheopen}{\isacharprime}a\ tag{\isacharunderscore}const{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{obtain}\isamarkupfalse%
\ x\isactrlsub {\isadigit{0}}{\isacharcolon}{\isacharcolon}{\isacharprime}a\ \isakeyword{where}\ {\isacartoucheopen}x\ {\isacharequal}\ TConst\ x\isactrlsub {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ tag{\isacharunderscore}const{\isachardot}exhaust\ \isacommand{obtain}\isamarkupfalse%
\ y\isactrlsub {\isadigit{0}}{\isacharcolon}{\isacharcolon}{\isacharprime}a\ \isakeyword{where}\ {\isacartoucheopen}y\ {\isacharequal}\ TConst\ y\isactrlsub {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}x\ {\isasymle}\ y\ {\isasymor}\ y\ {\isasymle}\ x{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}eq{\isacharunderscore}tag{\isacharunderscore}const{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/Recherche/Thesards/2014_Hai_NGUYEN_VAN/Heron_git/reiher2/reiher/src/TESL.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%45=8%:%
%:%57=10%:%
%:%66=13%:%
%:%78=15%:%
%:%82=16%:%
%:%84=17%:%
%:%87=20%:%
%:%88=20%:%
%:%89=21%:%
%:%90=21%:%
%:%91=22%:%
%:%92=23%:%
%:%93=23%:%
%:%94=24%:%
%:%101=27%:%
%:%113=29%:%
%:%115=31%:%
%:%116=31%:%
%:%117=32%:%
%:%118=33%:%
%:%119=34%:%
%:%120=35%:%
%:%121=36%:%
%:%122=37%:%
%:%123=38%:%
%:%124=39%:%
%:%125=40%:%
%:%127=43%:%
%:%129=45%:%
%:%130=45%:%
%:%132=48%:%
%:%133=49%:%
%:%135=51%:%
%:%136=51%:%
%:%137=52%:%
%:%138=53%:%
%:%140=56%:%
%:%142=58%:%
%:%143=58%:%
%:%144=59%:%
%:%145=60%:%
%:%154=64%:%
%:%166=66%:%
%:%167=67%:%
%:%168=68%:%
%:%170=70%:%
%:%171=70%:%
%:%172=71%:%
%:%173=72%:%
%:%174=72%:%
%:%175=73%:%
%:%176=74%:%
%:%177=75%:%
%:%178=75%:%
%:%179=76%:%
%:%180=77%:%
%:%181=78%:%
%:%182=78%:%
%:%183=79%:%
%:%184=80%:%
%:%185=81%:%
%:%186=81%:%
%:%187=82%:%
%:%188=83%:%
%:%189=84%:%
%:%190=84%:%
%:%191=85%:%
%:%192=86%:%
%:%193=86%:%
%:%194=87%:%
%:%195=88%:%
%:%196=89%:%
%:%197=89%:%
%:%198=90%:%
%:%199=91%:%
%:%200=91%:%
%:%201=92%:%
%:%202=93%:%
%:%203=94%:%
%:%206=94%:%
%:%210=94%:%
%:%213=95%:%
%:%215=96%:%
%:%216=96%:%
%:%217=97%:%
%:%218=97%:%
%:%219=98%:%
%:%220=98%:%
%:%221=98%:%
%:%222=99%:%
%:%223=99%:%
%:%224=100%:%
%:%225=100%:%
%:%226=101%:%
%:%229=102%:%
%:%231=103%:%
%:%232=103%:%
%:%233=104%:%
%:%234=104%:%
%:%235=104%:%
%:%236=104%:%
%:%237=105%:%
%:%238=105%:%
%:%239=106%:%
%:%240=106%:%
%:%241=107%:%
%:%244=108%:%
%:%246=109%:%
%:%247=109%:%
%:%248=110%:%
%:%249=110%:%
%:%250=110%:%
%:%251=110%:%
%:%252=111%:%
%:%253=111%:%
%:%254=112%:%
%:%255=112%:%
%:%256=113%:%
%:%259=114%:%
%:%261=115%:%
%:%262=115%:%
%:%263=116%:%
%:%264=116%:%
%:%265=117%:%
%:%266=117%:%
%:%267=117%:%
%:%268=118%:%
%:%269=118%:%
%:%270=119%:%
%:%271=119%:%
%:%272=120%:%
%:%275=121%:%
%:%277=122%:%
%:%278=122%:%
%:%279=123%:%
%:%280=123%:%
%:%281=123%:%
%:%282=123%:%
%:%283=124%:%
%:%284=124%:%
%:%285=125%:%
%:%286=125%:%
%:%287=126%:%
%:%290=127%:%
%:%292=128%:%
%:%293=128%:%
%:%294=129%:%
%:%295=129%:%
%:%296=129%:%
%:%297=129%:%
%:%298=130%:%
%:%299=130%:%
%:%300=131%:%
%:%301=131%:%
%:%302=132%:%
%:%305=133%:%
%:%307=134%:%
%:%308=134%:%
%:%309=135%:%
%:%310=135%:%
%:%311=135%:%
%:%312=135%:%
%:%313=136%:%
%:%314=136%:%
%:%315=137%:%
%:%316=137%:%
%:%317=138%:%
%:%318=139%:%
%:%319=140%:%
%:%322=141%:%
%:%324=142%:%
%:%325=142%:%
%:%326=143%:%
%:%327=143%:%
%:%328=143%:%
%:%329=143%:%
%:%330=144%:%
%:%331=144%:%
%:%332=145%:%
%:%333=145%:%
%:%334=146%:%
%:%337=147%:%
%:%339=148%:%
%:%340=148%:%
%:%341=149%:%
%:%342=149%:%
%:%343=150%:%
%:%344=150%:%
%:%345=150%:%
%:%346=151%:%
%:%347=151%:%
%:%348=152%:%
%:%349=152%:%
%:%350=153%:%
%:%351=154%:%
%:%352=155%:%
%:%355=156%:%
%:%357=157%:%
%:%358=157%:%
%:%359=158%:%
%:%360=158%:%
%:%361=159%:%
%:%364=160%:%
%:%366=161%:%
%:%367=161%:%
%:%368=161%:%
%:%369=162%:%
%:%370=162%:%
%:%371=162%:%
%:%372=162%:%
%:%373=163%:%
%:%374=163%:%
%:%375=163%:%
%:%376=163%:%
%:%377=163%:%
%:%378=164%:%
%:%379=164%:%
%:%380=164%:%
%:%381=165%:%
%:%382=165%:%
%:%383=166%:%
%:%386=167%:%
%:%388=168%:%
%:%389=168%:%
%:%390=169%:%
%:%391=169%:%
%:%392=169%:%
%:%393=169%:%
%:%394=170%:%
%:%395=170%:%
%:%396=171%:%
%:%397=171%:%
%:%398=172%:%
%:%399=173%:%
%:%400=174%:%
%:%401=175%:%
%:%404=176%:%
%:%406=177%:%
%:%407=177%:%
%:%408=178%:%
%:%409=178%:%
%:%410=179%:%
%:%418=179%:%
%:%419=180%:%
%:%420=181%:%
%:%423=184%:%
%:%425=187%:%
%:%426=187%:%
%:%427=188%:%
%:%428=189%:%
%:%429=189%:%
%:%430=190%:%
%:%431=191%:%
%:%432=192%:%
%:%433=193%:%
%:%434=193%:%
%:%435=194%:%
%:%436=195%:%
%:%439=195%:%
%:%443=195%:%
%:%444=195%:%
%:%445=196%:%
%:%446=196%:%
%:%447=197%:%
%:%448=197%:%
%:%449=197%:%
%:%450=198%:%
%:%451=198%:%
%:%452=199%:%
%:%453=199%:%
%:%454=200%:%
%:%455=200%:%
%:%456=200%:%
%:%457=200%:%
%:%458=201%:%
%:%459=201%:%
%:%460=201%:%
%:%461=201%:%
%:%462=202%:%
%:%463=202%:%
%:%464=203%:%
%:%465=203%:%
%:%466=204%:%
%:%467=204%:%
%:%468=204%:%
%:%469=205%:%
%:%470=205%:%
%:%471=206%:%
%:%472=206%:%
%:%473=207%:%
%:%474=207%:%
%:%475=207%:%
%:%476=208%:%
%:%484=208%:%
%:%485=209%:%
%:%486=210%:%
%:%489=213%:%
%:%491=215%:%
%:%492=215%:%
%:%493=216%:%
%:%494=217%:%
%:%497=217%:%
%:%501=217%:%
%:%502=217%:%
%:%503=218%:%
%:%504=218%:%
%:%505=219%:%
%:%506=219%:%
%:%507=219%:%
%:%508=219%:%
%:%509=220%:%
%:%510=220%:%
%:%511=220%:%
%:%512=220%:%
%:%513=220%:%
%:%514=221%:%
%:%515=221%:%
%:%516=221%:%
%:%517=221%:%
%:%518=221%:%
%:%519=222%:%
%:%527=222%:%
%:%528=223%:%
%:%529=224%:%
%:%530=224%:%
%:%533=225%:%
%:%538=226%:%