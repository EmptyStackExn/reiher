%
\begin{isabellebody}%
\setisabellecontext{Run}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Defining Runs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Run\isanewline
\isakeyword{imports}\ TESL\isanewline
\ \ \ \ \ \ \isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
Runs are sequences of instants, and each instant maps a clock to a pair that 
  tells whether the clock ticks or not, and what is the current time on this clock.
  The first element of the pair is called the \emph{hamlet} of the clock (to tick or 
  not to tick), the second element is called the \emph{time}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{abbreviation}\isamarkupfalse%
\ hamlet\ \isakeyword{where}\ {\isacartoucheopen}hamlet\ {\isasymequiv}\ fst{\isacartoucheclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ time\ \ \ \isakeyword{where}\ {\isacartoucheopen}time\ {\isasymequiv}\ snd{\isacartoucheclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ {\isacharprime}{\isasymtau}\ instant\ {\isacharequal}\ {\isacartoucheopen}clock\ {\isasymRightarrow}\ {\isacharparenleft}bool\ {\isasymtimes}\ {\isacharprime}{\isasymtau}\ tag{\isacharunderscore}const{\isacharparenright}{\isacartoucheclose}%
\begin{isamarkuptext}%
Runs have the additional constraint that time cannot go backwards on any clock
  in the sequence of instants.
Therefore, for any clock, the time projection of a run is monotonous.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{typedef}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{overloaded}{\isacharparenright}\ {\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}linordered{\isacharunderscore}field\ run\ {\isacharequal}\isanewline
\ \ {\isacartoucheopen}{\isacharbraceleft}\ {\isasymrho}{\isacharcolon}{\isacharcolon}nat\ {\isasymRightarrow}\ {\isacharprime}{\isasymtau}\ instant{\isachardot}\ {\isasymforall}c{\isachardot}\ mono\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ time\ {\isacharparenleft}{\isasymrho}\ n\ c{\isacharparenright}{\isacharparenright}\ {\isacharbraceright}{\isacartoucheclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}{\isasymlambda}{\isacharunderscore}\ {\isacharunderscore}{\isachardot}\ {\isacharparenleft}True{\isacharcomma}\ {\isasymtau}\isactrlsub c\isactrlsub s\isactrlsub t\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isasymin}\ {\isacharbraceleft}{\isasymrho}{\isachardot}\ {\isasymforall}c{\isachardot}\ mono\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ time\ {\isacharparenleft}{\isasymrho}\ n\ c{\isacharparenright}{\isacharparenright}{\isacharbraceright}{\isacartoucheclose}\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ mono{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Abs{\isacharunderscore}run{\isacharunderscore}inverse{\isacharunderscore}rewrite{\isacharcolon}\isanewline
\ \ {\isacartoucheopen}{\isasymforall}c{\isachardot}\ mono\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ time\ {\isacharparenleft}{\isasymrho}\ n\ c{\isacharparenright}{\isacharparenright}\ {\isasymLongrightarrow}\ Rep{\isacharunderscore}run\ {\isacharparenleft}Abs{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ {\isacharequal}\ {\isasymrho}{\isacartoucheclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Abs{\isacharunderscore}run{\isacharunderscore}inverse{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
\isa{run{\isacharunderscore}tick{\isacharunderscore}count\ {\isasymrho}\ K\ n} counts the number of ticks on clock \isa{K} 
  in the interval \isatt{[0{\char`\,}\ n]} of run \isa{{\isasymrho}}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ run{\isacharunderscore}tick{\isacharunderscore}count\ {\isacharcolon}{\isacharcolon}\ {\isacartoucheopen}{\isacharparenleft}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}linordered{\isacharunderscore}field{\isacharparenright}\ run\ {\isasymRightarrow}\ clock\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat{\isacartoucheclose}\isanewline
\ \ {\isacharparenleft}{\isachardoublequoteopen}{\isacharhash}\isactrlsub {\isasymle}\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharunderscore}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\isakeyword{where}\isanewline
\ \ {\isacartoucheopen}{\isacharparenleft}{\isacharhash}\isactrlsub {\isasymle}\ {\isasymrho}\ K\ {\isadigit{0}}{\isacharparenright}\ \ \ \ \ \ \ {\isacharequal}\ {\isacharparenleft}if\ hamlet\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ {\isadigit{0}}\ K{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ {\isadigit{0}}{\isacharparenright}{\isacartoucheclose}\isanewline
{\isacharbar}\ {\isacartoucheopen}{\isacharparenleft}{\isacharhash}\isactrlsub {\isasymle}\ {\isasymrho}\ K\ {\isacharparenleft}Suc\ n{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ hamlet\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ {\isacharparenleft}Suc\ n{\isacharparenright}\ K{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ {\isadigit{1}}\ {\isacharplus}\ {\isacharparenleft}{\isacharhash}\isactrlsub {\isasymle}\ {\isasymrho}\ K\ n{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\isacharhash}\isactrlsub {\isasymle}\ {\isasymrho}\ K\ n{\isacharparenright}{\isacharparenright}{\isacartoucheclose}%
\begin{isamarkuptext}%
\isa{run{\isacharunderscore}tick{\isacharunderscore}count{\isacharunderscore}strictly\ {\isasymrho}\ K\ n} counts the number of ticks on
  clock \isa{K} in the interval \isatt{[0{\char`\,}\ n[} of run \isa{{\isasymrho}}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ run{\isacharunderscore}tick{\isacharunderscore}count{\isacharunderscore}strictly\ {\isacharcolon}{\isacharcolon}\ {\isacartoucheopen}{\isacharparenleft}{\isacharprime}{\isasymtau}{\isacharcolon}{\isacharcolon}linordered{\isacharunderscore}field{\isacharparenright}\ run\ {\isasymRightarrow}\ clock\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat{\isacartoucheclose}\isanewline
\ \ {\isacharparenleft}{\isachardoublequoteopen}{\isacharhash}\isactrlsub {\isacharless}\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharunderscore}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\isakeyword{where}\isanewline
\ \ {\isacartoucheopen}{\isacharparenleft}{\isacharhash}\isactrlsub {\isacharless}\ {\isasymrho}\ K\ {\isadigit{0}}{\isacharparenright}\ \ \ \ \ \ \ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
{\isacharbar}\ {\isacartoucheopen}{\isacharparenleft}{\isacharhash}\isactrlsub {\isacharless}\ {\isasymrho}\ K\ {\isacharparenleft}Suc\ n{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharhash}\isactrlsub {\isasymle}\ {\isasymrho}\ K\ n{\isacartoucheclose}%
\begin{isamarkuptext}%
\isa{first{\isacharunderscore}time\ {\isasymrho}\ K\ n\ {\isasymtau}} tells whether instant \isa{n} in run \isa{{\isasymrho}}
  is the first one where the time on clock \isa{K} reaches \isa{{\isasymtau}}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ first{\isacharunderscore}time\ {\isacharcolon}{\isacharcolon}\ {\isacartoucheopen}{\isacharprime}a{\isacharcolon}{\isacharcolon}linordered{\isacharunderscore}field\ run\ {\isasymRightarrow}\ clock\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}a\ tag{\isacharunderscore}const\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymRightarrow}\ bool{\isacartoucheclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isacartoucheopen}first{\isacharunderscore}time\ {\isasymrho}\ K\ n\ {\isasymtau}\ {\isasymequiv}\ {\isacharparenleft}time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ n\ K{\isacharparenright}\ {\isacharequal}\ {\isasymtau}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\isasymnexists}n{\isacharprime}{\isachardot}\ n{\isacharprime}\ {\isacharless}\ n\ {\isasymand}\ time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ n{\isacharprime}\ K{\isacharparenright}\ {\isacharequal}\ {\isasymtau}{\isacharparenright}{\isacartoucheclose}%
\begin{isamarkuptext}%
The time on a clock is necessarily less than \isa{{\isasymtau}} before the first instant
  at which it reaches \isa{{\isasymtau}}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ before{\isacharunderscore}first{\isacharunderscore}time{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isacartoucheopen}first{\isacharunderscore}time\ {\isasymrho}\ K\ n\ {\isasymtau}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isacartoucheopen}m\ {\isacharless}\ n{\isacartoucheclose}\isanewline
\ \ \ \ \isakeyword{shows}\ {\isacartoucheopen}time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ m\ K{\isacharparenright}\ {\isacharless}\ {\isasymtau}{\isacartoucheclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}mono\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ time\ {\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}\ n\ K{\isacharparenright}{\isacharparenright}{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ Rep{\isacharunderscore}run\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}m\ {\isasymle}\ n{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}imp{\isacharunderscore}le\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}mono\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ time\ {\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}\ n\ K{\isacharparenright}{\isacharparenright}{\isacartoucheclose}\ \isacommand{using}\isamarkupfalse%
\ Rep{\isacharunderscore}run\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ \ {\isacartoucheopen}time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ m\ K{\isacharparenright}\ {\isasymle}\ time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ n\ K{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}mono{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ n\ K{\isacharparenright}\ {\isacharequal}\ {\isasymtau}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ first{\isacharunderscore}time{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ m\ K{\isacharparenright}\ {\isasymnoteq}\ {\isasymtau}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ first{\isacharunderscore}time{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This leads to an alternate definition of \isa{first{\isacharunderscore}time}:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ alt{\isacharunderscore}first{\isacharunderscore}time{\isacharunderscore}def{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isacartoucheopen}{\isasymforall}m\ {\isacharless}\ n{\isachardot}\ time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ m\ K{\isacharparenright}\ {\isacharless}\ {\isasymtau}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isacartoucheopen}time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ n\ K{\isacharparenright}\ {\isacharequal}\ {\isasymtau}{\isacartoucheclose}\isanewline
\ \ \ \ \isakeyword{shows}\ {\isacartoucheopen}first{\isacharunderscore}time\ {\isasymrho}\ K\ n\ {\isasymtau}{\isacartoucheclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}{\isasymforall}m\ {\isacharless}\ n{\isachardot}\ time\ {\isacharparenleft}{\isacharparenleft}Rep{\isacharunderscore}run\ {\isasymrho}{\isacharparenright}\ m\ K{\isacharparenright}\ {\isasymnoteq}\ {\isasymtau}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ less{\isacharunderscore}le{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ first{\isacharunderscore}time{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/Recherche/Thesards/2014_Hai_NGUYEN_VAN/Heron_git/reiher2/reiher/src/Run.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%40=8%:%
%:%41=9%:%
%:%42=10%:%
%:%43=11%:%
%:%45=14%:%
%:%46=14%:%
%:%47=15%:%
%:%48=15%:%
%:%49=16%:%
%:%50=17%:%
%:%51=17%:%
%:%53=20%:%
%:%54=21%:%
%:%55=22%:%
%:%57=24%:%
%:%58=24%:%
%:%59=25%:%
%:%66=26%:%
%:%67=26%:%
%:%68=27%:%
%:%69=27%:%
%:%70=28%:%
%:%71=28%:%
%:%72=28%:%
%:%73=29%:%
%:%79=29%:%
%:%82=30%:%
%:%83=31%:%
%:%84=31%:%
%:%85=32%:%
%:%92=33%:%
%:%93=33%:%
%:%102=36%:%
%:%103=37%:%
%:%105=39%:%
%:%106=39%:%
%:%107=40%:%
%:%108=41%:%
%:%109=42%:%
%:%111=44%:%
%:%112=45%:%
%:%116=50%:%
%:%117=51%:%
%:%119=53%:%
%:%120=53%:%
%:%121=54%:%
%:%122=55%:%
%:%123=56%:%
%:%124=57%:%
%:%126=60%:%
%:%127=61%:%
%:%129=63%:%
%:%130=63%:%
%:%131=64%:%
%:%132=65%:%
%:%133=66%:%
%:%136=70%:%
%:%137=71%:%
%:%139=73%:%
%:%140=73%:%
%:%141=74%:%
%:%142=75%:%
%:%143=76%:%
%:%150=77%:%
%:%151=77%:%
%:%152=78%:%
%:%153=78%:%
%:%154=78%:%
%:%155=78%:%
%:%156=79%:%
%:%157=79%:%
%:%158=79%:%
%:%159=79%:%
%:%160=79%:%
%:%161=79%:%
%:%162=80%:%
%:%163=80%:%
%:%164=80%:%
%:%165=80%:%
%:%166=80%:%
%:%167=81%:%
%:%168=81%:%
%:%169=81%:%
%:%170=82%:%
%:%171=82%:%
%:%172=83%:%
%:%173=83%:%
%:%174=83%:%
%:%175=83%:%
%:%176=84%:%
%:%177=84%:%
%:%178=84%:%
%:%179=85%:%
%:%180=85%:%
%:%181=85%:%
%:%182=85%:%
%:%183=86%:%
%:%184=86%:%
%:%185=86%:%
%:%186=87%:%
%:%187=87%:%
%:%188=87%:%
%:%189=87%:%
%:%190=88%:%
%:%200=91%:%
%:%202=93%:%
%:%203=93%:%
%:%204=94%:%
%:%205=95%:%
%:%206=96%:%
%:%213=97%:%
%:%214=97%:%
%:%215=98%:%
%:%216=98%:%
%:%217=98%:%
%:%218=99%:%
%:%219=99%:%
%:%220=100%:%
%:%221=100%:%
%:%222=100%:%
%:%223=100%:%
%:%224=101%:%
%:%230=101%:%
%:%235=102%:%
%:%240=103%:%