<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Denotational (Isabelle2016-1: December 2016)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Denotational</h1>

<span class="command">theory</span> <span class="name">Denotational</span><br/>
<span class="keyword">imports</span> <a href="Run.html"><span class="name">Run</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1">theory</span><span class=""> </span><span class="">Denotational</span><span class="">
</span><span class="keyword2">imports</span><span class="">
</span><span class="">    </span><span class="string">&quot;TESL&quot;</span><span class="">
</span><span class="">    </span><span class="string">&quot;Run&quot;</span><span class="">
</span><span class="">
</span><span class="keyword2">begin</span><span class="">
</span><span class="">
</span><span class="keyword1">section</span><span class=""> </span><span class="cartouche">&#8249;Denotational interpretation for atomic TESL formulae&#8250;</span><span class="">
</span><span class="">
</span><span class="comment">(* Denotational interpretation of TESL atomic formulae *)</span><span class="">
</span><span class="keyword1">fun</span><span class=""> </span><span class="">TESL_interpretation_atomic</span><span class="">
</span><span class="">    </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;TESL_atomic &#8658; run set&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;&#10214; _ &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">    </span><span class="string">&quot;&#10214; K sporadic &#964; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8707;n::nat. hamlet ((Rep_run &#961;) n K) = True &#8743; time ((Rep_run &#961;) n K) = &#964; }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214; K<span class="hidden">&#8681;</span><sub>1</sub> sporadic &#8970;&#964;&#8971; on K<span class="hidden">&#8681;</span><sub>2</sub> &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8707;n::nat. hamlet ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>1</sub>) = True &#8743; time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>2</sub>) = &#964; }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214; K<span class="hidden">&#8681;</span><sub>1</sub> sporadic &#8970;&#964;<span class="hidden">&#8681;</span><sub>v</sub><span class="hidden">&#8681;</span><sub>a</sub><span class="hidden">&#8681;</span><sub>r</sub>(K<span class="hidden">&#8681;</span><sub>i</sub>, n<span class="hidden">&#8681;</span><sub>i</sub>) &#8853; &#948;&#964;&#8971; on K<span class="hidden">&#8681;</span><sub>2</sub> &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8707;n::nat. hamlet ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>1</sub>) = True
                       &#8743; time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>2</sub>) = time ((Rep_run &#961;) n<span class="hidden">&#8681;</span><sub>i</sub> K<span class="hidden">&#8681;</span><sub>i</sub>) + &#948;&#964; }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214; tag-relation K<span class="hidden">&#8681;</span><sub>1</sub> = &#945; * K<span class="hidden">&#8681;</span><sub>2</sub> + &#946; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8704;n::nat. time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>1</sub>) = &#945; * time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>2</sub>) + &#946; }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214; tag-relation &#10216;K<span class="hidden">&#8681;</span><sub>1</sub>, K<span class="hidden">&#8681;</span><sub>2</sub>&#10217; &#8712; R &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8704;n::nat. R (time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>2</sub>)) }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214; master implies slave &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8704;n::nat. hamlet ((Rep_run &#961;) n master) &#10230; hamlet ((Rep_run &#961;) n slave) }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214; master time-delayed by &#948;&#964; on measuring implies slave &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> =
        { &#961;. &#8704;n. hamlet ((Rep_run &#961;) n master) &#10230;
                 (let measured_time = time ((Rep_run &#961;) n measuring) in
                  &#8707;m &#8805; n. hamlet ((Rep_run &#961;) m slave)
                          &#8743; time ((Rep_run &#961;) m measuring) = measured_time + &#948;&#964;
                 )
        }&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">section</span><span class=""> </span><span class="cartouche">&#8249;Denotational interpretation for TESL formulae&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">fun</span><span class=""> </span><span class="">TESL_interpretation</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;TESL_formula &#8658; run set&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;&#10214;&#10214; _ &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">    </span><span class="string">&quot;&#10214;&#10214; [] &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = { _. True }&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#966; # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8745; &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interpretation_homo</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8745; &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#966; # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Image interpretation lemma&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">theorem</span><span class=""> </span><span class="">TESL_interpretation_image</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#8898; ((&#955;&#966;. &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>) ` set &#934;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">&#934;</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">next</span><span class="">
</span><span class="">    </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">&#934;</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Expansion law&#8250;</span><span class="">
</span><span class="keyword1">text</span><span class=""> </span><span class="cartouche">&#8249;Similar to the expansion laws of lattices&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">theorem</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8745; &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">&#934;<span class="hidden">&#8681;</span><sub>1</sub></span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">next</span><span class="">
</span><span class="">    </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">&#934;<span class="hidden">&#8681;</span><sub>1</sub></span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Equational laws for TESL formulae denotationally interpreted&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_assoc</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; (&#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub>) @ &#934;<span class="hidden">&#8681;</span><sub>3</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ (&#934;<span class="hidden">&#8681;</span><sub>2</sub> @ &#934;<span class="hidden">&#8681;</span><sub>3</sub>) &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_commute</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>2</sub> @ &#934;<span class="hidden">&#8681;</span><sub>1</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="">inf_sup_aci</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_left_commute</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ (&#934;<span class="hidden">&#8681;</span><sub>2</sub> @ &#934;<span class="hidden">&#8681;</span><sub>3</sub>) &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>2</sub> @ (&#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>3</sub>) &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_idem</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; @ &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_left_idem</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ (&#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub>) &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_right_idem</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; (&#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub>) @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemmas</span><span class=""> </span><span class="">TESL_interp_aci</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="">TESL_interp_commute</span><span class=""> </span><span class="">TESL_interp_assoc</span><span class=""> </span><span class="">TESL_interp_left_commute</span><span class=""> </span><span class="">TESL_interp_left_idem</span><span class="">
</span><span class="">
</span><span class="comment">(* Identity element *)</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_neutral1</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; [] @ &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_neutral2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; @ [] &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1">section</span><span class=""> </span><span class="cartouche">&#8249;Decreasing interpretation of TESL formulae&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_sem_decreases_head</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#966; # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_sem_decreases_tail</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#934; @ [&#966;] &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_formula_stuttering</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">bel</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#966; &#8712; set &#934;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#966; # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">Int_subset_iff</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="">TESL_interpretation.simps</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">bel</span><span class=""> </span><span class="">in_set_conv_decomp_first</span><span class=""> </span><span class="">subset_antisym</span><span class=""> </span><span class="">subset_refl</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_decreases</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#966; # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">TESL_sem_decreases_head</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_remdups_absorb</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; remdups &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">&#934;</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">next</span><span class="">
</span><span class="">    </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">&#934;</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_formula_stuttering</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_set_lifting</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="string">&quot;set &#934; = set &#934;&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;&#39; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">     
</span><span class="">    </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;set (remdups &#934;) = set (remdups &#934;&#39;)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">assms</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">fxpnt&#934;</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8898; ((&#955;&#966;. &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>) ` set &#934;) = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">TESL_interpretation_image</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">fxpnt&#934;&#39;</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8898; ((&#955;&#966;. &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>) ` set &#934;&#39;) = &#10214;&#10214; &#934;&#39; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">TESL_interpretation_image</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8898; ((&#955;&#966;. &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>) ` set &#934;) = &#8898; ((&#955;&#966;. &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>) ` set &#934;&#39;)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">assms</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_remdups_absorb</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">theorem</span><span class=""> </span><span class="">TESL_interp_decreases_setinc</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">incl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;set &#934; &#8838; set &#934;&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#934;&#39; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">obtain</span><span class=""> </span><span class="">&#934;<span class="hidden">&#8681;</span><sub>r</sub></span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">decompose</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;set (&#934; @ &#934;<span class="hidden">&#8681;</span><sub>r</sub>) = set &#934;&#39;&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">incl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">    </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;set (&#934; @ &#934;<span class="hidden">&#8681;</span><sub>r</sub>) = set &#934;&#39;&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">incl</span><span class=""> </span><span class="">decompose</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;(set &#934;) &#8746; (set &#934;<span class="hidden">&#8681;</span><sub>r</sub>) = set &#934;&#39;&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">incl</span><span class=""> </span><span class="">decompose</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;&#39; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; @ &#934;<span class="hidden">&#8681;</span><sub>r</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_set_lifting</span><span class=""> </span><span class="">decompose</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; @ &#934;<span class="hidden">&#8681;</span><sub>r</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8745; &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>r</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">moreover</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8745; &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>r</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_decreases_add_head</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">incl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;set &#934; &#8838; set &#934;&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#966; # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#966; # &#934;&#39; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_decreases_setinc</span><span class=""> </span><span class="">incl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_decreases_add_tail</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">incl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;set &#934; &#8838; set &#934;&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; @ [&#966;] &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8839; &#10214;&#10214; &#934;&#39; @ [&#966;] &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">TESL_interp_commute</span><span class=""> </span><span class="">TESL_interp_decreases_add_head</span><span class=""> </span><span class="">append_Cons</span><span class=""> </span><span class="">append_Nil</span><span class=""> </span><span class="">incl</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_absorb1</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">incl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;set &#934;<span class="hidden">&#8681;</span><sub>1</sub> &#8838; set &#934;<span class="hidden">&#8681;</span><sub>2</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">Int_absorb1</span><span class=""> </span><span class="">TESL_interp_decreases_setinc</span><span class=""> </span><span class="">TESL_interp_homo_append</span><span class=""> </span><span class="">incl</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">TESL_interp_absorb2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">incl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;set &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#8838; set &#934;<span class="hidden">&#8681;</span><sub>1</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> @ &#934;<span class="hidden">&#8681;</span><sub>2</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934;<span class="hidden">&#8681;</span><sub>1</sub> &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">TESL_interp_absorb1</span><span class=""> </span><span class="">TESL_interp_commute</span><span class=""> </span><span class="">incl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Some special cases&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">NoSporadic_stable</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8838; &#10214;&#10214; NoSporadic &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">filter_is_subset</span><span class=""> </span><span class="">TESL_interp_decreases_setinc</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">NoSporadic_idem</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#8745; &#10214;&#10214; NoSporadic &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">Int_absorb2</span><span class=""> </span><span class="">filter_is_subset</span><span class=""> </span><span class="">TESL_interp_decreases_setinc</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">NoSporadic_setinc</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;set (NoSporadic &#934;) &#8838; set &#934;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">SporadicOn_sugar_atom</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214; K sporadic &#8970;&#964;&#8971; on K &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214; K sporadic &#964; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">SporadicOn_sugar</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214;&#10214; (K sporadic &#8970;&#964;&#8971; on K) # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214;&#10214; (K sporadic &#964;) # &#934; &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">Tagrel_affine_sugar</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;&#10214; tag-relation K<span class="hidden">&#8681;</span><sub>1</sub> = &#945; * K<span class="hidden">&#8681;</span><sub>2</sub> + &#946; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> = &#10214; tag-relation &#10216;K<span class="hidden">&#8681;</span><sub>1</sub>, K<span class="hidden">&#8681;</span><sub>2</sub>&#10217; &#8712; (&#955;(&#964;<span class="hidden">&#8681;</span><sub>1</sub>, &#964;<span class="hidden">&#8681;</span><sub>2</sub>). &#964;<span class="hidden">&#8681;</span><sub>1</sub> = &#945; * &#964;<span class="hidden">&#8681;</span><sub>2</sub> + &#946;) &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#10214; tag-relation &#10216;K<span class="hidden">&#8681;</span><sub>1</sub>, K<span class="hidden">&#8681;</span><sub>2</sub>&#10217; &#8712; (&#955;(&#964;<span class="hidden">&#8681;</span><sub>1</sub>, &#964;<span class="hidden">&#8681;</span><sub>2</sub>). &#964;<span class="hidden">&#8681;</span><sub>1</sub> = &#945; * &#964;<span class="hidden">&#8681;</span><sub>2</sub> + &#946;) &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>
       = { &#961;. &#8704;n::nat. (&#955;(&#964;<span class="hidden">&#8681;</span><sub>1</sub>, &#964;<span class="hidden">&#8681;</span><sub>2</sub>). &#964;<span class="hidden">&#8681;</span><sub>1</sub> = &#945; * &#964;<span class="hidden">&#8681;</span><sub>2</sub> + &#946;) (time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run &#961;) n K<span class="hidden">&#8681;</span><sub>2</sub>)) }&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword2">end</span><span class="">
</span></pre>

</div>
</body>
</html>
